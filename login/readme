base是login和register公用函数